# ─────────────────────────────────────────────
# OpenClaw4J — Application Configuration
# ─────────────────────────────────────────────
spring:
  application:
    name: openclaw4j
  profiles:
    active: dev
  main:
    web-application-type: servlet
  
  # Global AI Defaults - Disabled by default to prevent bean conflicts
  # Only one should be enabled via profiles below.
  ai:
    openai:
      api-key: ${SPRING_AI_OPENAI_API_KEY:any}
      chat:
        enabled: false
        options:
          model: gpt-4o
    ollama:
      base-url: http://localhost:11434
      chat:
        enabled: false
        options:
          model: kimi-k2-thinking:cloud
    model:
      embedding: ${openclaw4j.ai.provider:ollama}
    mcp:
      client:
        stdio:
          connections:
            github:
              command: npx
              args:
                - "-y"
                - "@modelcontextprotocol/server-github"
              env:
                GITHUB_PERSONAL_ACCESS_TOKEN: ${GITHUB_TOKEN:}
    vectorstore:
      pgvector:
        index-type: HNSW
        distance-type: COSINE_DISTANCE
        dimensions: 1024 # Default for Ollama model kimi-k2-thinking:cloud
        initialize-schema: true
  
  datasource:
    url: ${JDBC_URL:jdbc:postgresql://localhost:5432/openclaw4j}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver

server:
  port: 8080

# ─────────────────────────────────────────────
# OpenClaw4J Agent Configuration (Common)
# ─────────────────────────────────────────────
openclaw4j:
  channel:
    slack:
      bot-token: ${SLACK_BOT_TOKEN:}
      signing-secret: ${SLACK_SIGNING_SECRET:}
    whatsapp:
      access-token: ${WHATSAPP_ACCESS_TOKEN:}
      phone-number-id: ${WHATSAPP_PHONE_NUMBER_ID:}
      verify-token: ${WHATSAPP_VERIFY_TOKEN:}
      api-version: v21.0
  ai:
    # Options: openai, ollama
    provider: ollama
  rag:
    enabled: true
    channels: ${SLACK_CHANNEL_IDS:}
  tools:
    github:
      token: ${GITHUB_TOKEN:}
      owner: ${GITHUB_OWNER:}
      repo: ${GITHUB_REPO:}
    search:
      api-key: ${TAVILY_API_KEY:}
      enabled: ${SEARCH_ENABLED:false}
      base-url: ${TAVILY_BASE_URL:https://api.tavily.com}
      api-path: ${TAVILY_API_PATH:/search}
      search-depth: ${TAVILY_SEARCH_DEPTH:basic}
      include-answer: ${TAVILY_INCLUDE_ANSWER:true}
      max-results: ${TAVILY_MAX_RESULTS:5}

# ─────────────────────────────────────────────
# Actuator — Health & Monitoring
# ─────────────────────────────────────────────
management:
  endpoints:
    web:
      exposure:
        include: health, info
  endpoint:
    health:
      show-details: always

# ─────────────────────────────────────────────
# Logging
# ─────────────────────────────────────────────
logging:
  level:
    dev.prasadgaikwad.openclaw4j: DEBUG
    com.slack.api: INFO
    org.springframework.ai: INFO

---
# ─────────────────────────────────────────────
# Profile: openai (Default startup profile)
# ─────────────────────────────────────────────
spring:
  config:
    activate:
      on-profile: openai
  ai:
    openai:
      chat:
        enabled: true

---
# ─────────────────────────────────────────────
# Profile: ollama
# ─────────────────────────────────────────────
spring:
  config:
    activate:
      on-profile: ollama
  ai:
    ollama:
      chat:
        enabled: true
